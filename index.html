<!DOCTYPE html>
<html>
<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="/">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A new Flutter project.">

  <!-- iOS meta tags & icons -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="mds_home">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png"/>

  <title>NFL Draft Simulator</title>
  <meta id="meta-description" name="description" content="NFL Draft Simulator - Simulate your own NFL draft picks">
  <meta id="meta-keywords" name="keywords" content="NFL, draft, simulator, football, fantasy">
  <meta id="meta-og-title" property="og:title" content="NFL Draft Simulator">
  <meta id="meta-og-description" property="og:description" content="NFL Draft Simulator - Simulate your own NFL draft picks">
  <meta id="meta-og-url" property="og:url" content="">
  <meta id="meta-og-image" property="og:image" content="">

  <link rel="manifest" href="manifest.json">

  <!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>

<script>
  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCLO_VAZ9l6PK541-tFkYRquISv5x1I-Dw",
    authDomain: "nfl-draft-simulator-9265f.firebaseapp.com",
    projectId: "nfl-draft-simulator-9265f",
    storageBucket: "nfl-draft-simulator-9265f.firebasestorage.app",
    messagingSenderId: "900728713837",
    appId: "1:900728713837:web:3e0c47b05b144c758f8564",
    measurementId: "G-8QGNSTTZGH"
  };
  
  // Initialize Firebase
  if (typeof firebase !== 'undefined') {
    console.log("Initializing Firebase from index.html");
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
  } else {
    console.error("Firebase SDK not loaded properly");
  }

  function updateMetadata(title, description, keywords, url, imageUrl) {
      document.title = title || 'NFL Draft Simulator';
      
      const metaDescription = document.getElementById('meta-description');
      if (metaDescription) {
        metaDescription.setAttribute('content', description || 'NFL Draft Simulator - Simulate your own NFL draft picks');
      }
      
      const metaKeywords = document.getElementById('meta-keywords');
      if (metaKeywords) {
        metaKeywords.setAttribute('content', keywords || 'NFL, draft, simulator, football, fantasy');
      }
      
      const metaOgTitle = document.getElementById('meta-og-title');
      if (metaOgTitle) {
        metaOgTitle.setAttribute('content', title || 'NFL Draft Simulator');
      }
      
      const metaOgDescription = document.getElementById('meta-og-description');
      if (metaOgDescription) {
        metaOgDescription.setAttribute('content', description || 'NFL Draft Simulator - Simulate your own NFL draft picks');
      }
      
      const metaOgUrl = document.getElementById('meta-og-url');
      if (metaOgUrl) {
        metaOgUrl.setAttribute('content', url || window.location.href);
      }
      
      const metaOgImage = document.getElementById('meta-og-image');
      if (metaOgImage && imageUrl) {
        metaOgImage.setAttribute('content', imageUrl);
      }
    }
    
    // Function to parse URL and update metadata for blog posts
    function updateBlogMetadata() {
      const path = window.location.pathname;
      if (path.startsWith('/blog/')) {
        // Extract slug from URL
        const slug = path.replace('/blog/', '').split('/')[0];
        
        // Call the Flutter app's metadata method once it's ready
        window.addEventListener('flutterInAppWebViewPlatformReady', function(event) {
          if (window.flutter_inappwebview && window.flutter_inappwebview.callHandler) {
            window.flutter_inappwebview.callHandler('getBlogMetadata', slug)
              .then(function(result) {
                if (result) {
                  updateMetadata(
                    result.title + ' | NFL Draft Simulator', 
                    result.description,
                    result.keywords,
                    window.location.href,
                    result.imageUrl
                  );
                }
              });
          }
        });
      }
    }
    
    // Run on page load
    document.addEventListener('DOMContentLoaded', updateBlogMetadata);
</script>

</head>
<body>
  <script src="flutter_bootstrap.js" async></script>
</body>
</html>
